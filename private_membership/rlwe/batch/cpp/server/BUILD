licenses(["notice"])

package(default_visibility = ["//:__subpackages__"])

cc_library(
    name = "server",
    srcs = ["server.cc"],
    hdrs = ["server.h"],
    visibility = ["//visibility:public"],
    deps = [
        "//private_membership/rlwe/batch/cpp:constants",
        "//private_membership/rlwe/batch/cpp:context",
        "//private_membership/rlwe/batch/cpp:encoding",
        "//private_membership/rlwe/batch/cpp:parameters",
        "//private_membership/rlwe/batch/cpp:prng",
        "//private_membership/rlwe/batch/proto:server_cc_proto",
        "//private_membership/rlwe/batch/proto:shared_cc_proto",
        "@com_github_google_shell//shell_encryption:galois_key",
        "@com_github_google_shell//shell_encryption:int256",
        "@com_github_google_shell//shell_encryption:montgomery",
        "@com_github_google_shell//shell_encryption:oblivious_expand",
        "@com_github_google_shell//shell_encryption:polynomial",
        "@com_github_google_shell//shell_encryption:serialization_cc_proto",
        "@com_github_google_shell//shell_encryption:symmetric_encryption",
        "@com_github_google_shell//shell_encryption:symmetric_encryption_with_prng",
        "@com_github_google_shell//shell_encryption:transcription",
        "@com_github_google_shell//shell_encryption/prng",
        "@com_google_absl//absl/algorithm:container",
        "@com_google_absl//absl/container:flat_hash_map",
        "@com_google_absl//absl/container:flat_hash_set",
        "@com_google_absl//absl/meta:type_traits",
        "@com_google_absl//absl/status",
        "@com_google_absl//absl/status:statusor",
    ],
)

cc_test(
    name = "server_test",
    srcs = ["server_test.cc"],
    shard_count = 2,
    deps = [
        ":server",
        "//private_membership/rlwe/batch/cpp:constants",
        "//private_membership/rlwe/batch/cpp:context",
        "//private_membership/rlwe/batch/cpp:encoding",
        "//private_membership/rlwe/batch/cpp:parameters",
        "//private_membership/rlwe/batch/cpp:test_helper",
        "//private_membership/rlwe/batch/cpp/client",
        "//private_membership/rlwe/batch/proto:client_cc_proto",
        "//private_membership/rlwe/batch/proto:server_cc_proto",
        "//private_membership/rlwe/batch/proto:shared_cc_proto",
        "@com_github_google_googletest//:gtest_main",
        "@com_github_google_shell//shell_encryption:context",
        "@com_github_google_shell//shell_encryption:polynomial",
        "@com_github_google_shell//shell_encryption:serialization_cc_proto",
        "@com_github_google_shell//shell_encryption:symmetric_encryption",
        "@com_google_absl//absl/container:flat_hash_map",
        "@com_google_absl//absl/container:flat_hash_set",
        "@com_google_absl//absl/memory",
        "@com_google_absl//absl/status",
        "@com_google_absl//absl/status:statusor",
        "@com_google_absl//absl/strings",
    ],
)
